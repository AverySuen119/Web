<!DOCTYPE html>
<html lang="zh-Hans">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1.0" />
  <title>Event Details â€” Animal Welfare</title>
  <link rel="stylesheet" href="/css/styles.css" />
</head>
<body>
 
  <header class="navbar">
    <div class="container">
      <div class="nav-brand">
        <a href="/">Animal Welfare</a>
      </div>
      <nav class="nav-menu">
        <a href="/" class="nav-link">é¦–é¡µ</a>
        <a href="/search.html" class="nav-link ">æ´»åŠ¨æœç´¢</a>
        <button class="nav-link nav-register-btn">æ³¨å†Œ</button>
      </nav>
      <!-- æ·»åŠ æç¤ºæ¡†ï¼ˆåˆå§‹éšè—ï¼‰ -->
      <div id="register-toast" class="toast" style="display: none;">
        <p>æ­¤åŠŸèƒ½å¼€å‘ä¸­</p>
      </div>
    </div>
  </header>

  <main class="container">

    <section id="event-container" class="event-details">
      <div class="loading-state">
        <div class="loading-spinner"></div>
        <p>åŠ è½½æ´»åŠ¨è¯¦æƒ…ä¸­â€¦</p>
      </div>
    </section>
  </main>

<!-- æ–°å¢é¡µè„š -->
<footer class="footer">
  <div class="container">
    <div class="footer-grid">
      <div class="footer-column">
        <h3 class="footer-title">About Us</h3>
        <p>We are dedicated to supporting animal welfare through community events, adoption fairs, and fundraising for shelters and wildlife protection.</p>
      </div>
      <div class="footer-column">
        <h3 class="footer-title">Quick Links</h3>
        <ul class="footer-links">
          <li><a href="/index.html">Home</a></li>
          <li><a href="/events.html">Events</a></li>
          <li><a href="/about.html">About</a></li>
          <li><a href="/contact.html">Contact</a></li>
        </ul>
      </div>
      <div class="footer-column">
        <h3 class="footer-title">Contact Info</h3>
        <ul class="footer-contact">
          <li>Email: <a href="mailto:info@charityevents.org">info@charityevents.org</a></li>
          <li>Phone: <a href="tel:+61290000101">+61 2 9000 0101</a></li>
          <li>Address: 12 Animal St, Petville</li>
        </ul>
      </div>
      <div class="footer-column">
        <h3 class="footer-title">Follow Us</h3>
        <div class="footer-social">
          <a href="https://x.com/charityevents" target="_blank" class="social-icon">
            <svg viewBox="0 0 24 24" width="24" height="24" fill="#fff"><path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"></path></svg>
          </a>
          <a href="https://facebook.com/charityevents" target="_blank" class="social-icon">
            <svg viewBox="0 0 24 24" width="24" height="24" fill="#fff"><path d="M9 8H7v4h2v12h5V12h3.642l.358-4H14V6.5c0-.827.673-1.5 1.5-1.5H18V0h-2.5C12.462 0 10 2.462 10 5.5V8z"></path></svg>
          </a>
        </div>
      </div>
    </div>
    <div class="footer-bottom">
      <p>&copy; 2025 Charity Events. All rights reserved.</p>
    </div>
  </div>
</footer>

  <script type="module">
    import { getEventById } from './js/api.js';

    function escapeHtml(str = '') {
      return String(str)
        .replace(/&/g, '&amp;')
        .replace(/</g, '&lt;')
        .replace(/>/g, '&gt;')
        .replace(/"/g, '&quot;')
        .replace(/'/g, '&#39;');
    }

    const container = document.getElementById('event-container');

    function getEventIdFromURL() {
      const params = new URLSearchParams(window.location.search);
      return params.get('id');
    }

    async function loadEvent() {
      const id = getEventIdFromURL();
      if (!id) {
        container.innerHTML = '<div class="error-state"><p>æœªæä¾›æ´»åŠ¨ID</p></div>';
        return;
      }

      try {
        const event = await getEventById(id);
        if (!event) {
          container.innerHTML = '<div class="error-state"><p>æ´»åŠ¨æœªæ‰¾åˆ°</p></div>';
          return;
        }

        const evDate = new Date(event.event_date || event.eventDate);
        const dateStr = evDate.toLocaleDateString('zh-CN', {
          year: 'numeric',
          month: 'long',
          day: 'numeric',
          weekday: 'long'
        });
        const timeStr = evDate.toLocaleTimeString('zh-CN', {
          hour: '2-digit',
          minute: '2-digit'
        });
        const price = event.is_free ? 'å…è´¹å‚ä¸' : `Â¥${Number(event.price || 0).toFixed(2)}`;

        container.innerHTML = `
          <article class="event-detail-card">
            <div class="event-hero-image">
              <img
                src="${event.image_url || '/images/event-default.jpg'}"
                alt="${escapeHtml(event.name)}"
                loading="lazy"
                onerror="this.onerror=null; this.src='/images/event-default.jpg';"
              >
            </div>

            <div class="event-content">
              <div class="event-header">
                <div class="event-category-tag">${escapeHtml(event.category_name || '')}</div>
                <div class="event-price-tag ${event.is_free ? 'free' : 'paid'}">${price}</div>
              </div>

              <h1 class="event-title">${escapeHtml(event.name)}</h1>

              <div class="event-info-grid">
                <div class="info-item">
                  <div class="info-label">ğŸ“… æ´»åŠ¨æ—¥æœŸ</div>
                  <div class="info-value">${dateStr}</div>
                </div>
                <div class="info-item">
                  <div class="info-label">â° æ´»åŠ¨æ—¶é—´</div>
                  <div class="info-value">${timeStr}</div>
                </div>
                <div class="info-item">
                  <div class="info-label">ğŸ“ æ´»åŠ¨åœ°ç‚¹</div>
                  <div class="info-value">${escapeHtml(event.location_name || 'åœ°ç‚¹å¾…å®š')}</div>
                </div>
              </div>

              
              <div class="event-description">
                <h3>æ´»åŠ¨ä»‹ç»</h3>
                <div class="description-content">
                  ${escapeHtml(event.full_desc || 'æš‚æ— è¯¦ç»†æè¿°')}
                </div>
              </div>

              <div class="event-actions">
                <button class="btn btn-primary btn-large" id="register-btn">ç«‹å³æŠ¥å</button>
                <button class="btn btn-secondary" onclick="window.history.back()">è¿”å›åˆ—è¡¨</button>
              </div>
            </div>
          </article>
        `;
        document.addEventListener('DOMContentLoaded', () => {
  const registerBtn = document.querySelector('.nav-register-btn');
  const toast = document.getElementById('register-toast');

  registerBtn.addEventListener('click', () => {
    toast.style.display = 'block';
    toast.classList.add('show');
    setTimeout(() => {
      toast.classList.remove('show');
      setTimeout(() => {
        toast.style.display = 'none';
      }, 300); // ç­‰å¾…æ·¡å‡ºåŠ¨ç”»å®Œæˆ
    }, 3000); // æ˜¾ç¤º3ç§’
  });
});

        const registerBtn = document.getElementById('register-btn');
        registerBtn.addEventListener('click', () => {
          alert('æŠ¥ååŠŸèƒ½æ­£åœ¨å¼€å‘ä¸­ï¼Œæ•¬è¯·æœŸå¾…ï¼');
        });

      } catch (err) {
        console.error(err);
        container.innerHTML = '<div class="error-state"><p>åŠ è½½æ´»åŠ¨è¯¦æƒ…å¤±è´¥</p></div>';
      }
    }

    document.addEventListener('DOMContentLoaded', loadEvent);
  </script>
</body>
</html>
